<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Media Pembelajaran Interaktif (All-in-One)</title>
  <style>
    /* ==== (style tetap sama seperti sebelumnya, tidak dihapus) ==== */
    :root{
      --primary:#2a4d8f;
      --accent:#4a90e2;
      --bg1: #e3f2fd;
      --bg2: #f3f5f7;
      --card:#ffffff;
      --muted:#777;
      --shadow: 0 6px 18px rgba(38,72,126,0.08);
      --radius:12px;
      font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html, body {
      min-height:100%;
      margin:0;
      padding:0;
      background:linear-gradient(135deg,var(--bg1),var(--bg2));
      color:#222;
    }

    .app {
      display:flex;
      flex-direction:column;
      align-items:stretch;
      min-height:100vh;
      padding:28px;
      box-sizing:border-box;
    }

    .container {
      width:100%;
      max-width:1100px;
      margin:0 auto;
      padding:30px;
      background:transparent;
      box-sizing:border-box;
    }

    h1.app-title {text-align:center;color:var(--primary);margin:0 0 18px 0;font-size:28px}
    .sub {text-align:center;color:var(--muted);margin-bottom:22px}

    .menu-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
      gap:28px;
      align-items:stretch;
    }

    .menu-item {
      background:var(--card);
      border-radius:20px;
      box-shadow:var(--shadow);
      padding:22px 12px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:8px;
      cursor:pointer;
      transition:transform .22s ease, box-shadow .22s ease, background .22s;
      color:var(--primary);
      text-align:center;
      min-height:150px;
    }

    .menu-item:hover{
      transform:translateY(-8px);
      box-shadow:0 14px 30px rgba(38,72,126,0.12);
      background:var(--accent);
      color:#fff;
    }

    .menu-item img{width:72px;height:72px;display:block;object-fit:contain}
    .menu-item span{font-weight:600;font-size:15px;display:block;margin-top:6px}

    .page {display:none;}
    .page.active {display:block}

    .back-btn {
      position:fixed;
      top:16px;
      left:16px;
      width:48px;height:48px;
      border-radius:50%;
      background:var(--accent);
      color:#fff;
      border:none;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 6px 18px rgba(0,0,0,0.12);
      cursor:pointer;
      z-index:999;
      font-size:18px;
    }
    .back-btn:hover{transform:scale(1.04)}
    .page-header {text-align:center;color:var(--primary);margin-top:10px}

    .content-wrap {
      width:95%;
      max-width:960px;
      margin:20px auto;
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px;
      box-sizing:border-box;
    }

    .viewer {
      width:100%;
      height:640px;
      border-radius:10px;
      overflow:hidden;
      background:#000;
    }
    .viewer iframe{width:100%;height:100%;border:0;display:block}

    .controls-row {display:flex;gap:10px;align-items:center;justify-content:center;margin-top:14px}
    .btn {
      background:var(--accent);color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-weight:600;
      box-shadow:0 6px 18px rgba(74,144,226,0.12)
    }
    .btn.ghost {background:transparent;color:var(--primary);border:1px solid rgba(0,0,0,0.06)}
    .desc {text-align:center;color:var(--muted);margin-top:8px}

    /* Canvas interaktif */
    #canvasWrapper {
      display:flex;
      gap:18px;
      align-items:flex-start;
      justify-content:center;
      flex-wrap:wrap;
      margin-top:10px;
    }

    #canvas {
      position:relative;
      width:65%;
      min-width:320px;
      height:520px;
      border:2px solid #ccc;
      border-radius:12px;
      background:#fff;
      overflow:hidden;
    }

    #drawCanvas {
      position:absolute;top:0;left:0;width:100%;height:100%;background:transparent;z-index:4;
    }

    #elements-layer {
      position:absolute;top:0;left:0;width:100%;height:100%;z-index:5;
    }

    #petunjuk {
      position:absolute;top:45%;left:50%;transform:translate(-50%,-50%);color:#777;font-size:16px;text-align:center;
    }

    #canvasKunci {width:30%;min-width:220px;border:2px dashed #aaa;border-radius:12px;padding:10px;background:#fafafa;text-align:center;display:none;}
    #canvasKunci img {width:100%;max-height:480px;object-fit:contain;border-radius:8px }

    #elemenContainer {margin-top:16px;width:100%;display:flex;flex-direction:column;align-items:center}
    #elemenList {display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin-top:8px}

    .elemen {width:90px;height:90px;border:2px solid #ccc;border-radius:8px;background:#fff;display:flex;align-items:center;justify-content:center;cursor:grab}
    .elemen img {width:80%;height:80%;object-fit:contain}

    .resizable {position:absolute;border:1px dashed #aaa;border-radius:6px;background:transparent;cursor:move; touch-action: none;}
    .resizable img{width:100%;height:100%;object-fit:contain;pointer-events:none}
    .resize-handle{position:absolute;bottom:0;right:0;width:14px;height:14px;background:var(--accent);border-radius:50%;cursor:se-resize}

    /* Scroll video horizontal */
    .video-scroll {
      display: flex;
      gap: 20px;
      overflow-x: auto;
      padding-bottom: 10px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
    }

    .video-scroll iframe {
      width: 320px;
      height: 180px;
      flex-shrink: 0;
      border-radius: 12px;
      border: none;
      scroll-snap-align: start;
      background:#000;
    }
    .video-scroll::-webkit-scrollbar {display:none;}

    @media (max-width:1024px){
      .viewer {height:480px;}
      #canvas {width:100%;height:400px;}
    }
    @media (max-width:720px){
      .viewer {height:320px;}
      #canvas {height:320px;}
      .video-scroll iframe {width:260px;height:150px;}
    }
  </style>
</head>
<body>

<button id="globalBack" class="back-btn" style="display:none">‚¨ÖÔ∏è</button>

<div class="app">
  <div class="container">

    <!-- Dashboard -->
    <section id="dashboard" class="page active">
      <h1 class="app-title">üéì Media Pembelajaran Interaktif</h1>

      <div class="menu-grid">
        <div class="menu-item" data-target="materi"><img src="assets/icon-materi.png"><span>Materi</span></div>
        <div class="menu-item" data-target="modul"><img src="assets/icon-modul.png"><span>Modul</span></div>
        <div class="menu-item" data-target="video"><img src="assets/icon-video.png"><span>Video</span></div>
        <div class="menu-item" data-target="interaktif"><img src="assets/icon-interaktif.png"><span>Media Interaktif</span></div>
      </div>
    </section>

    <!-- Materi -->
    <section id="materi" class="page">
      <h2 class="page-header">üìñ Materi</h2>
      <div class="content-wrap">
        <div class="viewer"><iframe id="slidesFrame"
          src="https://docs.google.com/presentation/d/e/GOOGLE_SLIDES_EMBED_URL/embed"></iframe>
        </div>
        <div class="controls-row">
          <button class="btn" onclick="openInNewTab(slidesFrame.src)">Buka di Tab Baru</button>
          <button class="btn ghost" onclick="showSection('dashboard')">Kembali</button>
        </div>
      </div>
    </section>

    <!-- Modul PDF -->
    <section id="modul" class="page">
      <h2 class="page-header">üìë Modul Pembelajaran</h2>
      <div class="content-wrap">
        <div class="viewer"><iframe id="pdfFrame" src="assets/modul.pdf"></iframe></div>
        <div class="controls-row">
          <button class="btn" onclick="openInNewTab('assets/modul.pdf')">üì• Unduh / Buka PDF</button>
          <button class="btn ghost" onclick="showSection('dashboard')">Kembali</button>
        </div>
      </div>
    </section>

    <!-- Video -->
    <section id="video" class="page">
      <h2 class="page-header">üé¨ Video Pembelajaran</h2>
      <div class="content-wrap">
        <div class="video-scroll">
          <iframe src="https://www.youtube.com/embed/ASBNa7b-7MQ"></iframe>
          <iframe src="https://www.youtube.com/embed/aON_if40J_8"></iframe>
          <iframe src="https://www.youtube.com/embed/SJ739--Vc3A"></iframe>
        </div>
        <div class="controls-row">
          <button class="btn ghost" onclick="showSection('dashboard')">Kembali</button>
        </div>
      </div>
    </section>

    <!-- Interaktif -->
    <section id="interaktif" class="page">
      <h2 class="page-header">üß∞ Media Interaktif: Merangkai Elemen Setrika</h2>

      <div id="canvasWrapper" class="content-wrap">
        <div id="canvas">
          <canvas id="drawCanvas"></canvas>
          <div id="elements-layer"></div>
          <div id="petunjuk">üß© Silakan seret elemen ke area ini</div>
        </div>
        <div id="canvasKunci">
          <h3>üîç Susunan Benar</h3>
          <img src="assets/kunciJawaban.png" id="imgKunci">
        </div>
      </div>

      <div class="content-wrap">
        <h4>üé® Elemen</h4>
        <div id="elemenList">
          <div class="elemen" id="elemenA" draggable="true"><img src="assets/titikA.png"></div>
          <div class="elemen" id="elemenB" draggable="true"><img src="assets/titikB.png"></div>
          <div class="elemen" id="elemenC" draggable="true"><img src="assets/titikC.png"></div>
          <div class="elemen" id="elemenD" draggable="true"><img src="assets/titikD.png"></div>
          <div class="elemen" id="elemenE" draggable="true"><img src="assets/titikE.png"></div>
        </div>

        <div class="controls-row" style="margin-top:16px;">
          <button class="btn" id="modeDraw">‚úèÔ∏è Mode Gambar</button>
          <button class="btn" id="modeClick">üñ±Ô∏è Mode Klik</button>
          <button class="btn" id="undo">‚Ü©Ô∏è Undo</button>
          <button class="btn ghost" id="toggleKunci">üëÅÔ∏è Kunci Jawaban</button>
          <button class="btn ghost" onclick="showSection('dashboard')">Kembali</button>
        </div>
      </div>

    </section>

  </div>
</div>

<script>
/* ==== Navigasi ==== */
const pages=document.querySelectorAll('.page');
const menuItems=document.querySelectorAll('.menu-item');
const globalBack=document.getElementById('globalBack');

function showSection(id){
  pages.forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  globalBack.style.display=(id==='dashboard')?'none':'flex';
  if(id==='interaktif'){ initMediaInteractive(); setTimeout(resizeDrawCanvas, 100); }
}
menuItems.forEach(mi=>mi.onclick=()=>showSection(mi.dataset.target));
globalBack.onclick=()=>showSection('dashboard');

/* ==== Media Interaktif ==== */
let mediaInitialized=false,mode="draw",drawing=false,startX,startY,lines=[],tempStart=null;
const canvasArea=document.getElementById("canvas");
const drawCanvas=document.getElementById("drawCanvas");
const elementsLayer=document.getElementById("elements-layer");
const petunjuk=document.getElementById("petunjuk");
const btnDraw=document.getElementById("modeDraw");
const btnClick=document.getElementById("modeClick");
const btnUndo=document.getElementById("undo");
const btnKunci=document.getElementById("toggleKunci");
const canvasKunci=document.getElementById("canvasKunci");

function resizeDrawCanvas(){
  const r=canvasArea.getBoundingClientRect();
  drawCanvas.width=r.width; drawCanvas.height=r.height;
  redrawAll();
}

window.initMediaInteractive=function(){
  if(mediaInitialized) return;
  mediaInitialized=true;
  resizeDrawCanvas();

  btnDraw.onclick=()=>setMode("draw");
  btnClick.onclick=()=>setMode("click");
  btnUndo.onclick=undoLine;
  btnKunci.onclick=()=>canvasKunci.style.display =
    canvasKunci.style.display==="none"?"block":"none";

  document.querySelectorAll(".elemen").forEach(el=>{
    el.ondragstart=e=>e.dataTransfer.setData("id",el.id);
  });
  elementsLayer.ondragover=e=>e.preventDefault();
  elementsLayer.ondrop=handleDrop;
};

function handleDrop(e){
  e.preventDefault();
  const id=e.dataTransfer.getData("id");
  const src=document.querySelector("#"+id+" img").src;
  petunjuk.style.display="none";

  const rect=elementsLayer.getBoundingClientRect();
  const x=e.clientX-rect.left-40;
  const y=e.clientY-rect.top-40;

  const box=document.createElement("div");
  box.className="resizable";
  box.style="left:"+x+"px;top:"+y+"px;width:100px;height:100px";
  box.innerHTML="<img src='"+src+"'><div class='resize-handle'></div>";

  elementsLayer.appendChild(box);
  makeDraggable(box);
  makeResizable(box,box.querySelector(".resize-handle"));
}

function setMode(m){
  mode=m; tempStart=null; drawing=false;
  drawCanvas.style.pointerEvents=(m==="draw")?"auto":"none";
  elementsLayer.style.pointerEvents=(m==="click")?"auto":"none";
  if(m==="draw") activateDraw(); else activateClick();
}

function undoLine(){ lines.pop(); redrawAll(); }

function activateDraw(){
  drawCanvas.onmousedown=e=>{
    drawing=true;
    const r=drawCanvas.getBoundingClientRect();
    startX=e.clientX-r.left; startY=e.clientY-r.top;
  }
  drawCanvas.onmousemove=e=>{
    if(!drawing) return;
    const r=drawCanvas.getBoundingClientRect();
    redrawAll();
    let x=e.clientX-r.left,y=e.clientY-r.top;
    const c=drawCanvas.getContext("2d");
    c.beginPath(); c.moveTo(startX,startY); c.lineTo(x,y);
    c.lineWidth=3; c.stroke();
  }
  drawCanvas.onmouseup=e=>{
    drawing=false;
    const r=drawCanvas.getBoundingClientRect();
    lines.push({
      x1:startX,y1:startY,
      x2:e.clientX-r.left,
      y2:e.clientY-r.top
    });
    redrawAll();
  }
}

function activateClick(){
  drawCanvas.onclick=e=>{
    const r=drawCanvas.getBoundingClientRect();
    let x=e.clientX-r.left,y=e.clientY-r.top;
    if(!tempStart){ tempStart={x,y}; drawPoint(x,y,"red"); }
    else{ lines.push({x1:tempStart.x,y1:tempStart.y,x2:x,y2:y}); tempStart=null; redrawAll(); }
  }
}

function drawPoint(x,y,col){
  const c=drawCanvas.getContext("2d");
  c.beginPath(); c.arc(x,y,4,0,Math.PI*2); c.fillStyle=col; c.fill();
}

function redrawAll(){
  const c=drawCanvas.getContext("2d");
  c.clearRect(0,0,drawCanvas.width,drawCanvas.height);
  lines.forEach(l=>{
    c.beginPath(); c.moveTo(l.x1,l.y1); c.lineTo(l.x2,l.y2);
    c.lineWidth=3; c.stroke();
  });
}

/* Drag & resize elemen */
function makeDraggable(el){
  let drag=false,ox,oy;
  el.onmousedown=e=>{
    if(e.target.classList.contains("resize-handle")) return;
    drag=true;
    const r=elementsLayer.getBoundingClientRect();
    ox=e.clientX-r.left-el.offsetLeft;
    oy=e.clientY-r.top-el.offsetTop;
  }
  document.onmousemove=e=>{
    if(!drag) return;
    const r=elementsLayer.getBoundingClientRect();
    el.style.left=(e.clientX-r.left-ox)+"px";
    el.style.top =(e.clientY-r.top -oy)+"px";
  }
  document.onmouseup=()=>drag=false;
}

function makeResizable(el,handle){
  let rs=false,sx,sy,sw,sh;
  handle.onmousedown=e=>{
    rs=true; sx=e.clientX; sy=e.clientY;
    sw=el.offsetWidth; sh=el.offsetHeight;
    e.stopPropagation();
  }
  document.onmousemove=e=>{
    if(!rs) return;
    el.style.width =(sw+(e.clientX-sx))+"px";
    el.style.height=(sh+(e.clientY-sy))+"px";
  }
  document.onmouseup=()=>rs=false;
}
</script>

</body>
</html>
